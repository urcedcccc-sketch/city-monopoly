<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<title>ä¸–ç•Œå¤§å¯Œç¿ D3.3.1</title>
<style>
html,body{margin:0;background:#000;color:#0ff;font-family:Arial;height:100%;overflow:hidden;}
#ui{position:absolute;top:10px;width:100%;text-align:center;z-index:10}
button{background:#000;border:2px solid #0ff;color:#0ff;padding:6px 14px;margin:4px;border-radius:8px;cursor:pointer}
#game{display:flex;justify-content:center;align-items:center;height:100%}
#boardWrapper{position:relative;width:620px;height:620px;border:4px solid #0ff;border-radius:20px;box-shadow:0 0 30px #0ff;display:grid;grid-template-columns:repeat(6,1fr);grid-template-rows:repeat(6,1fr)}
.tile{border-radius:12px;border:2px solid rgba(0,255,255,.5);display:flex;flex-direction:column;align-items:center;justify-content:center;font-size:12px;position:relative;text-align:center;transition:0.3s}
.owner1{background:rgba(255,0,0,0.25);box-shadow:0 0 20px red inset}
.owner2{background:rgba(0,255,255,0.25);box-shadow:0 0 20px cyan inset}
.chain{box-shadow:0 0 30px gold inset}
.token{width:14px;height:14px;border-radius:50%;position:absolute;bottom:4px;right:4px}
.p1{background:red}
.p2{background:cyan}
#dice{position:absolute;width:90px;height:90px;left:50%;top:50%;transform:translate(-50%,-50%);background:#fff;border-radius:20px;display:flex;justify-content:center;align-items:center;font-size:36px;color:black;cursor:pointer;box-shadow:0 0 30px #fff}
#bank{width:200px;margin-left:20px;border:2px solid #0ff;padding:10px;border-radius:10px}
#victory{position:fixed;left:0;top:0;width:100%;height:100%;background:rgba(0,0,0,.9);display:none;justify-content:center;align-items:center;flex-direction:column;font-size:22px;z-index:999}
</style>
</head>
<body>

<div id="victory"></div>

<div id="ui">
<button onclick="mode='ai'">AI</button>
<button onclick="mode='pvp'">åŒäºº</button>
å½“å‰ï¼š<span id="turnLabel"></span>
</div>

<div id="game">
<div id="boardWrapper"><div id="dice">ğŸ²</div></div>
<div id="bank">
<div id="p1info"></div>
<div id="p2info"></div>
<button onclick="loan()">å€Ÿ200</button>
</div>
</div>

<script>
const cityData=[
{name:"åŒ—äº¬",price:60,rent:10},{name:"ä¸Šæµ·",price:70,rent:12},{name:"ä¸œäº¬",price:80,rent:14},{name:"é¦–å°”",price:90,rent:16},{name:"æ–°åŠ å¡",price:100,rent:18},
{name:"ä¼¦æ•¦",price:120,rent:24},{name:"å·´é»",price:130,rent:26},{name:"æŸæ—",price:140,rent:28},{name:"ç½—é©¬",price:150,rent:30},{name:"çº½çº¦",price:160,rent:32},
{name:"å¤šä¼¦å¤š",price:180,rent:40},{name:"æ¸©å“¥å",price:190,rent:42},{name:"ä¼Šæ–¯å¦å¸ƒå°”",price:200,rent:44},{name:"å¼€ç½—",price:210,rent:46},{name:"å¼€æ™®æ•¦",price:220,rent:48},
{name:"é‡Œçº¦",price:260,rent:70},{name:"åœ£ä¿ç½—",price:280,rent:75},{name:"å¢¨è¥¿å“¥åŸ",price:300,rent:80},{name:"æ‚‰å°¼",price:320,rent:90},{name:"èµ·ç‚¹",price:0,rent:0}
];

const zones=[[0,1,2,3,4],[5,6,7,8,9],[10,11,12,13,14],[15,16,17,18,19]];
const levelIcon=["","ğŸ ","ğŸ¢","ğŸ™"];

let tiles=[],owners=new Array(20).fill(null),levels=new Array(20).fill(0);

const posLayout=[[1,1],[2,1],[3,1],[4,1],[5,1],[6,1],[6,2],[6,3],[6,4],[6,5],[6,6],[5,6],[4,6],[3,6],[2,6],[1,6],[1,5],[1,4],[1,3],[1,2]];
const board=document.getElementById("boardWrapper");

for(let i=0;i<20;i++){
let t=document.createElement("div");
t.className="tile";
t.style.gridColumn=posLayout[i][0];
t.style.gridRow=posLayout[i][1];
t.innerHTML=`${cityData[i].name}<br>$${cityData[i].price}<div id="b${i}"></div>`;
board.appendChild(t);
tiles.push(t);
}

let players=[{pos:0,cash:500,debt:0,el:null},{pos:0,cash:500,debt:0,el:null}];
players.forEach((p,i)=>{let d=document.createElement("div");d.className="token "+(i==0?"p1":"p2");tiles[0].appendChild(d);p.el=d;});

let turn=0,mode="ai",gameOver=false;

function hasChain(p,z){return z.filter(i=>owners[i]===p).length>=3;}
function getZone(i){return zones.find(z=>z.includes(i));}
function asset(p){
let total=players[p].cash;
for(let i=0;i<20;i++) if(owners[i]===p) total+=cityData[i].price+levels[i]*cityData[i].price*0.5;
return total;
}

function updateUI(){
p1info.textContent="ç©å®¶1 ğŸ’°"+players[0].cash+" ğŸ¦"+players[0].debt;
p2info.textContent="ç©å®¶2 ğŸ’°"+players[1].cash+" ğŸ¦"+players[1].debt;
turnLabel.textContent="ç©å®¶"+(turn+1);
for(let i=0;i<20;i++){
document.getElementById("b"+i).textContent=levelIcon[levels[i]];
tiles[i].classList.remove("owner1","owner2");
if(owners[i]===0) tiles[i].classList.add("owner1");
if(owners[i]===1) tiles[i].classList.add("owner2");
}
}

dice.onclick=()=>{if(!gameOver && !(mode==="ai"&&turn===1))roll();};

function roll(){
const v=Math.floor(Math.random()*6)+1;
dice.textContent=v;
move(v);
}

function move(v){
let p=players[turn];
tiles[p.pos].removeChild(p.el);
p.pos=(p.pos+v)%20;
tiles[p.pos].appendChild(p.el);
land();
turn=1-turn;
updateUI();
if(mode==="ai"&&turn===1 && !gameOver)setTimeout(roll,800);
}

function land(){
let i=players[turn].pos, city=cityData[i];
if(city.price===0)return;
let zone=getZone(i);
if(owners[i]===null){
if(players[turn].cash>city.price){
players[turn].cash-=city.price;
owners[i]=turn;
}
}else if(owners[i]!==turn){
let mult=1+levels[i]*0.5;if(hasChain(owners[i],zone))mult*=1.5;
let rent=city.rent*mult;
players[turn].cash-=rent;players[owners[i]].cash+=rent;
if(players[turn].cash<0)endGame(turn);
}else{
let cost=city.price*0.5;
if(players[turn].cash>=cost && levels[i]<3){players[turn].cash-=cost;levels[i]++;}
}
}

function loan(){if(!gameOver){players[turn].cash+=200;players[turn].debt+=200;updateUI();}}

function endGame(loser){
gameOver=true;
let winner=1-loser;
victory.style.display="flex";
victory.innerHTML=`
ğŸ† ç©å®¶${winner+1} è·èƒœ<br><br>
ç°é‡‘ï¼š$${players[winner].cash}<br>
æ€»èµ„äº§ï¼š$${asset(winner)}<br><br>
<button onclick="location.reload()">å†æ¥ä¸€å±€</button>
`;
}
updateUI();
</script>
</body>
</html>
